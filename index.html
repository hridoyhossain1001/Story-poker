<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Protocol Poker</title>

    <meta property="og:title" content="♠️ Story Protocol Poker Night">
    <meta property="og:description" content="Click below to join the table! Win IP rewards & have fun.">
    <meta property="og:image" content="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExZ25uNHZ6bnZ6bnZ6bnZ6bnZ6bnZ6bnZ6bnZ6bnZ6bnZ6bnZ6bnZ6/26gR0l63J5M0Xj7wY/giphy.gif">
    <meta name="theme-color" content="#FF0000"> <meta property="twitter:card" content="summary_large_image">


    <style>
        body { font-family: 'Courier New', Courier, monospace; background: #0f0f0f; color: #e0e0e0; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        .container { text-align: center; width: 90%; max-width: 400px; }
        
        /* ADMIN PANEL */
        .admin-box { background: #1a1a1a; padding: 25px; border: 2px solid #d32f2f; border-radius: 10px; box-shadow: 0 0 20px rgba(211, 47, 47, 0.2); }
        input { width: 100%; padding: 12px; margin: 15px 0; background: #000; border: 1px solid #444; color: #fff; border-radius: 5px; box-sizing: border-box; font-family: inherit;}
        input:focus { outline: none; border-color: #d32f2f; }
        button { width: 100%; padding: 15px; background: linear-gradient(45deg, #d32f2f, #b71c1c); color: white; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; letter-spacing: 1px; text-transform: uppercase; transition: 0.3s; }
        button:hover { opacity: 0.9; transform: scale(1.02); }
        
        /* LOADING SCREEN */
        .loader { display: none; }
        .spinner { border: 5px solid #333; border-top: 5px solid #d32f2f; border-radius: 50%; width: 50px; height: 50px; animation: spin 0.8s linear infinite; margin: 0 auto 25px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .status-text { font-size: 18px; font-weight: bold; letter-spacing: 1px; }
        
        .hidden { display: none !important; }
        .result-link { margin-top: 20px; background: #000; padding: 15px; font-size: 14px; word-break: break-all; color: #00e5ff; border: 1px dashed #d32f2f; border-radius: 5px; }
    </style>

    <script>
        window.onload = function() {
            // ১. চেক করা হচ্ছে লিংকে কোনো গেম কোড আছে কিনা (# এর পর)
            const hash = window.location.hash.substring(1); // e.g., story-poker-284-xxxx

            if (hash) {
                // === PLAYER VIEW === (যদি কোড থাকে)
                document.getElementById('adminPanel').classList.add('hidden');
                document.getElementById('loadingScreen').style.display = 'block';
                
                // আসল লিংক তৈরি করা হচ্ছে
                const realLink = "https://www.pokernow.club/mtt/" + hash;
                
                // ১.৫ সেকেন্ড পর ইউজারকে রিডাইরেক্ট করা হবে
                setTimeout(() => {
                    window.location.replace(realLink); // replace ব্যবহার করা ভালো
                }, 1500);
            } else {
                // === ADMIN VIEW === (যদি কোড না থাকে)
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('loadingScreen').style.display = 'none';
            }
        };

        // লিংক জেনারেট করার ফাংশন
        function generateCleanLink() {
            const rawInput = document.getElementById('pokerLink').value.trim();
            
            // ইনপুট থেকে শুধু শেষের কোডটুকু আলাদা করা
            let gameCode = "";
            if (rawInput.includes("/mtt/")) {
                gameCode = rawInput.split("/mtt/")[1];
            } else if (rawInput.length > 10 && !rawInput.includes("http")) {
                gameCode = rawInput; // যদি কেউ শুধু কোড পেস্ট করে
            }

            if (!gameCode) { 
                alert("❌ Invalid Link! Please paste the full PokerNow link."); return; 
            }

            // ক্লিন লিংক তৈরি
            const cleanLink = window.location.origin + "/#" + gameCode;

            // রেজাল্ট দেখানো
            const resultDiv = document.getElementById('result');
            resultDiv.classList.remove('hidden');
            resultDiv.innerHTML = "<b style='color: #d32f2f;'>✅ Copy for Discord:</b><br><br>" + cleanLink;
        }
    </script>
</head>
<body>

    <div class="container">
        <div id="loadingScreen" class="loader">
            <div class="spinner"></div>
            <p class="status-text">Connecting to Table...</p>
            <p style="font-size: 12px; color: #666;">Don't close this window.</p>
        </div>

        <div id="adminPanel" class="admin-box hidden">
            <h2 style="margin-top: 0; color: #d32f2f;">♠️ Table Manager</h2>
            <p style="font-size: 14px; color: #aaa;">Paste today's PokerNow link below:</p>
            <input type="text" id="pokerLink" placeholder="https://www.pokernow.club/mtt/...">
            <button onclick="generateCleanLink()">CREATE SHARE LINK</button>
            
            <div id="result" class="result-link hidden"></div>
        </div>
    </div>

</body>
</html>
